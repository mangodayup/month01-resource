# Day 15   2021/1/20  星期三

---

# 异常处理Error

## 异常

- 定义：运行时检测到的错误。（非语法错误：代码写错了，而是逻辑错误：运行时因数据超过有效范围而引发的错误）

- 现象：当异常发生时，程序不会再向下执行，而转到函数的调用语句，直到不能再网上翻。

- 常见异常类型：
  - 名称异常(NameError)：变量未定义。
  - 类型异常(TypeError)：不同类型数据进行运算。
  - 索引异常(IndexError)：超出索引范围。
  - 属性异常(AttributeError)：对象没有对应名称的属性。
  - 键异常(KeyError)：没有对应名称的键。
  - 异常基类Exception。

## 处理

1. 语法：

   ```python
      #写法一：官方不建议，直接把所有代码放到try里，然后except Exception统一处理（只告诉你错了，没告诉你怎么错了：包治百病）
     
     #写法二：对症下药
      try:
   
        		可能触发异常的语句
   
      except 错误类型1 [as 变量1]：
   
        		处理语句1
   
      except 错误类型2 [as 变量2]：
   
        		处理语句2
     
     #写法三：加finally，无论是否发生异常都会执行的语句
     try:
   
        		可能触发异常的语句
   
      except 错误类型1 [as 变量1]：
   
        		处理语句1
   
      except 错误类型2 [as 变量2]：
   
        		处理语句2
   
      except Exception [as 变量3]：
   
        		不是以上错误类型的处理语句
   
      else:
   
        		未发生异常的语句
   
      finally:
   
      			无论是否发生异常的语句
   ```

   

2. 作用：将程序由异常状态转为正常流程。
3. 说明：
   - as 子句是用于绑定错误对象的变量，可以省略
   - except子句可以有一个或多个，用来捕获某种类型的错误。
   - else子句最多只能有一个。
   - finally子句最多只能有一个，如果没有except子句，必须存在。

## raise 语句

1. 作用：抛出一个错误，让程序进入异常状态。

2. 目的：在程序调用层数较深时，向主调函数传递错误信息要层层return 比较麻烦，所以人为抛出异常，可以直接传递错误信息。

# 迭代

每一次对过程的重复称为一次“迭代”，而每一次迭代得到的结果会作为下一次迭代的初始值。例如：循环获取容器中的元素。

因为for自定义对象，第一步就是.iter()函数，所以就要在自定义对象中创建一个iter()函数；

迭代（for循环原理）

## 可迭代对象iterable 

1. 定义：具有__iter__函数的对象，可以返回迭代器对象。

2. 语法

-- 创建：

class 可迭代对象名称:

 def __iter__(self):

   return 迭代器

-- 使用：

for 变量名 in 可迭代对象:

语句

3. 原理：

迭代器 = 可迭代对象.__iter__()

while True:

  try: 

​    print(迭代器.__next__())

  except StopIteration:

​        break

## 迭代器对象iterator

1. 定义：可以被next()函数调用并返回下一个值的对象。
2.  语法

class 迭代器类名:

  def __init__(self, 聚合对象):

​    self.聚合对象= 聚合对象  

  def __next__(self): 

​    if 没有元素:

​      raise StopIteration

​      return 聚合对象元素

3. 说明：

   -- 聚合对象通常是容器对象。

4. 作用：使用者只需通过一种方式，便可简洁明了的获取聚合对象中各个元素，而又无需了解其内部结构。

# 生成器generator

1. 定义：能够动态(循环一次计算一次返回一次)提供数据的可迭代对象。

2. 作用：在循环过程中，按照某种算法推算数据，不必创建容器存储完整的结果，从而节省内存空间。数据量越大，优势越明显。

3. 以上作用也称之为延迟操作或惰性操作，通俗的讲就是在需要的时候才计算结果，而不是一次构建出所有结果。

## 生成器函数

1. 定义：含有yield语句的函数，返回值为生成器对象。

2. 语法

-- 创建：

def 函数名():

…

yield 数据

…

 -- 调用：

  for 变量名 in 函数名():

​     语句

3. 说明：

-- 调用生成器函数将返回一个生成器对象，不执行函数体。

-- yield翻译为”产生”或”生成”

4. 执行过程：

(1)  调用生成器函数会自动创建迭代器对象。

(2)  调用迭代器对象的__next__()方法时才执行生成器函数。

(3)  每次执行到yield语句时返回数据，暂时离开。

(4)  待下次调用__next__()方法时继续从离开处继续执行。

5. 原理：生成迭代器对象的大致规则如下

-- 将yield关键字以前的代码放在next方法中。

-- 将yield关键字后面的数据作为next方法的返回值。

